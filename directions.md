# 使用说明
```
脚本启动时，会检查是否以管理员权限运行。
如果不是管理员权限，会弹出警告框提示用户以管理员权限运行。
虽然依旧可以打开脚本，但有可能(其实是百分百)会出问题，建议以管理员权限打开脚本。
```

## 使用方法
### 单开
1. 添加任务
    - 点击左侧导航栏的“任务”按钮切换到任务页面。
    - 点击右侧面板最上方的“添加任务”按钮添加新的任务。
    - 任务添加后，会在任务列表中显示出来。
    - 可以自由调整顺序。
2. 设置任务参数
    - 点击右侧面板最上方的“任务配置”按钮。
    - 目前仅支持一键设置所有任务的参数，无法单独设置。
    - 根据需要修改参数值，确保参数设置符合要求。
    - 推荐参数：
        - 目标窗口标题：游戏窗口的标题，用于定位目标窗口。默认值为“一梦江湖”，可根据实际窗口名称修改（只要窗口名称中包含对应字符即可）。
        - 任务超时时间（秒）：任务执行的超时时间，超过该时间任务会被强制停止。默认值为600秒，主要是为了防止 bug，可以设长一点，不过一般能正常跑的话大概最多也就三五分钟就跑完了。
        - 循环次数：任务执行的循环次数，默认值为1次。
        - 基准窗口大小：截取模板图片时的窗口用户界面的大小，用于尺寸比例换算。默认值为2560*1330(我截取模板时的分辨率)，如果想自己换模板的话记得改。
        - 默认模板匹配阈值：模板匹配的默认阈值，用于判断模板是否匹配成功。默认值为0.6，推荐调整到0.7左右。
        - 点击后的默认等待时间（秒）：点击操作后的默认等待时间，用于等待目标窗口响应。默认值为3秒，主要是为了防止点击操作过快导致游戏 ui 反应不过来，推荐1.5~2秒。
        - 捕获失败重试延迟（秒）：捕获目标窗口失败后的重试延迟时间，用于等待窗口出现。默认值为3秒，一般用不到，一般来说捕获失败的话应该在绑定窗口的时候就报错。
        - 模板匹配失败重试延迟（秒）：模板匹配失败后的重试延迟时间，用于等待模板出现。默认值为0.5秒，每个模板匹配失败后会等待0.5秒再重新匹配，防止 cpu 占用过高，推荐0.1~0.3秒。
        - 模板匹配循环延迟（秒）：模板匹配循环的延迟时间，用于控制匹配的频率。默认值为2秒，主要是为了防止直接使用游戏内的挂机功能的时候还在那哐哐跑，推荐1.5秒以上。
3. 绑定窗口
    - 点击右侧面板最上方的“查找窗口”按钮，脚本会自动查找标题含有任务配置中的“目标窗口标题”的所有当前打开的窗口，并将这些窗口的句柄添加到下拉列表中。
    - 从下拉列表选择一个句柄，点击“显示窗口”按钮，会将选中的窗口激活并置顶。
    - 点击“绑定窗口”按钮，脚本会将选中的窗口绑定到脚本。
4. 运行任务
    - 点击右侧面板最上方的“运行任务”按钮开始运行任务。
    - 任务运行过程中，可点击“停止任务”按钮随时停止运行。
    - 点击“暂停任务”按钮可以暂停任务的运行。
    - 点击“继续任务”按钮可以继续任务的运行。

### 多开
- 点击左侧导航栏的“多开”按钮切换到多开页面。
- 首先要在左侧的任务列表添加想要执行的任务，任务执行时会按照列表中的顺序运行。列表有右键菜单，右键点击项目就能删了
- 添加好任务后，先在右侧面板输入一下进程名（其实不输入也行，不影响）
- 然后点击刷新窗口列表，就可以在按钮左边的下拉框中选择目标窗口了。（记得要开游戏）
- 以上步骤完成后，点击添加进程按钮，就会在多开列表中添加一个进程。
- 可以在多开列表中，选择进程，此时各种按钮都会亮起，点击按钮即可操作选中的进程。
    - 点击“运行任务”按钮可以运行选中进程的任务。
    - 点击“停止任务”按钮可以停止选中进程的任务。
    - 点击“移除进程”按钮可以删除选中进程。
- 可能会出点小问题，不过我测试的时候基本都修好了，勉强能用。
- 最好不要多开功能和上面的单独控制任务同时使用，虽然应该不会出问题，但不建议。
- 选中进程列表中的项目后，左侧的任务列表会显示选中进程的任务，选中的进程处在停止/未运行状态的话可以通过任务列表下方的“更新任务列表”按钮更新选中进程任务列表。
- 如果进程列表之类的出现比较奇怪的问题话可以尝试把进程先删了再重新添加一下。

## 注意事项
- 此脚本仅支持Windows11系统的pc端，win10应该也能用，不确定。
- 请确保在运行脚本前，已经打开了目标窗口，并且窗口名称与设置的窗口名称一致。
- 脚本运行期间可以操作其它窗口，但不要将游戏窗口最小化。
- 脚本运行过程中，不要关闭目标窗口，否则会导致脚本运行异常。
- 游戏窗口的大小最好保持在1600x900左右，实测这个大小的窗口匹配效果较好，1200x600左右也行，别太大也别太小（这是我测试的分辨率，1440p, 如果屏幕是 1080p 的话可能 1280x720 也不错？）。
- 目前仅支持日常任务和论剑，别的还没写。
- 目前资源占用似乎有点高，我自己测的时候直接占了二百多MB内存（以后再优化一下）
